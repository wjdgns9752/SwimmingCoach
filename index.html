<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="description" content="수영 훈련과 자세 교정을 위한 나만의 일일 코치">
  <title>일일 스위밍 코치</title>
  <link href='style.css' rel='stylesheet'>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>

  <!-- Onboarding Modal -->
  <div id="onboarding-overlay" class="onboarding-overlay">
    <div class="onboarding-content">
      <h1>환영합니다! 👋</h1>
      <p>코칭을 시작하기 위해 기본 정보를 알려주세요.</p>
      
      <div class="onboarding-form">
          <label for="onboard-nickname">닉네임</label>
          <input type="text" id="onboard-nickname" placeholder="예: 물개, 마린보이" autocomplete="off">
      </div>

      <p class="sub-text">현재 수영 실력은 어느 정도인가요?</p>
      
      <div class="level-grid">
        <button class="level-card" onclick="completeOnboarding('beginner')">
          <div class="level-icon">🐣</div>
          <h3>초급 (Beginner)</h3>
          <p>물 적응, 기초 호흡 및 발차기</p>
        </button>
        <button class="level-card" onclick="completeOnboarding('intermediate')">
          <div class="level-icon">🏊</div>
          <h3>중급 (Intermediate)</h3>
          <p>자유형/배영 마스터, 25m 완주 가능</p>
        </button>
        <button class="level-card" onclick="completeOnboarding('advanced')">
          <div class="level-icon">🐬</div>
          <h3>상급 (Advanced)</h3>
          <p>4가지 영법 구사, 턴/스타트 숙련</p>
        </button>
        <button class="level-card" onclick="completeOnboarding('masters')">
          <div class="level-icon">🏅</div>
          <h3>마스터즈 (Masters)</h3>
          <p>대회 준비, 기록 단축 훈련</p>
        </button>
        <button class="level-card" onclick="completeOnboarding('elite')">
          <div class="level-icon">🏆</div>
          <h3>선수 (Elite)</h3>
          <p>전문 선수, 한계 돌파 훈련</p>
        </button>
      </div>
    </div>
  </div>

  <!-- Workout Detail Modal -->
  <div id="workout-modal" class="modal-overlay hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modal-title">훈련 상세 가이드</h2>
            <button class="close-btn" onclick="closeWorkoutModal()">&times;</button>
        </div>
        <div class="modal-body" id="modal-body">
            <!-- Populated by JS -->
        </div>
    </div>
  </div>

  <!-- App Header -->
  <header class="app-header">
    <div class="logo">
      <span class="logo-icon">🏊</span>
      <span class="logo-text" data-i18n="appTitle">스위밍코치</span>
    </div>
    
    <div style="display:flex; align-items:center; gap: 1rem;">
        <nav class="desktop-nav">
          <ul>
            <li><a href="#" data-page="dashboard" class="nav-link active" data-i18n="navDashboard">대시보드</a></li>
            <li><a href="#" data-page="logger" class="nav-link" data-i18n="navLogger">훈련 일지</a></li>
            <li><a href="#" data-page="analysis" class="nav-link" data-i18n="navAnalysis">AI 분석</a></li>
            <li><a href="#" data-page="club" class="nav-link" data-i18n="navClub">클럽</a></li>
            <li><a href="#" data-page="profile" class="nav-link" data-i18n="navProfile">내 기록</a></li>
          </ul>
        </nav>
        
        <select id="language-selector" class="lang-select">
            <option value="ko">🇰🇷 한국어</option>
            <option value="en">🇺🇸 English</option>
            <option value="jp">🇯🇵 日本語</option>
            <option value="cn">🇨🇳 中文</option>
        </select>
    </div>
  </header>

  <main class="app-container">
    
    <!-- PAGE: DASHBOARD -->
    <section id="dashboard-page" class="page-section active">
      <div class="hero-mini">
        <h1 id="user-greeting" data-i18n="greeting">오늘도 물살을 가를 준비 되셨나요?</h1>
        <p id="dashboard-goal" class="hero-sub">목표: 설정되지 않음</p>
      </div>

      <div class="features">
        <div class="feature-card main-plan-card">
          <div class="card-header">
              <div class="icon">📝</div>
              <h3 data-i18n="dailyPlanTitle">오늘의 맞춤 훈련</h3>
          </div>
          <p id="daily-plan-text">데이터 로딩 중...</p>
          <div class="card-footer">
              <span class="status-badge" id="user-level-badge">Level</span>
              <span class="tap-hint" onclick="openTerminologyModal()" style="cursor:pointer; text-decoration:underline; margin-right:10px;" data-i18n="termHint">훈련 용어 설명 보기</span>
              <span class="tap-hint" data-i18n="tapDetails">터치하여 상세 가이드 &rarr;</span>
          </div>
        </div>

        <div class="feature-card">
          <div class="icon">📅</div>
          <h3 data-i18n="weeklyDistTitle">이번 주 누적 거리</h3>
          <p id="total-distance-display" class="big-number">0 m</p>
        </div>
        
        <div class="feature-card">
          <div class="icon">🏆</div>
          <h3 data-i18n="recentCompTitle">최근 대회 기록</h3>
          <p id="pr-display" class="big-number-sm">None</p>
          <button class="link-btn" onclick="navigateTo('profile')" data-i18n="btnAddRecord">기록 추가하기</button>
        </div>
      </div>
    </section>

    <!-- PAGE: LOGGER -->
    <section id="logger-page" class="page-section hidden">
      <div class="page-header">
        <h2 data-i18n="loggerTitle">훈련 일지 작성</h2>
      </div>
      
      <form id="swim-log-form" class="logger-form">
        <div class="form-card">
            <h3 data-i18n="dateLabel">📅 날짜 및 시간</h3>
            <div class="input-group">
                <input type="date" id="date" required>
                <div class="duration-input">
                    <input type="number" id="duration" placeholder="45" required min="0" style="margin-top:0.5rem">
                    <span class="unit">Min</span>
                </div>
            </div>
        </div>

        <div class="form-card">
            <h3 data-i18n="distLabel">🏊 수영 거리</h3>
            <div class="distance-input-wrapper">
                <input type="number" id="distance" placeholder="1500" required min="0" step="50">
                <span class="unit-large">m</span>
            </div>
            <div class="quick-add-buttons">
                <button type="button" onclick="addDistance(500)">+500</button>
                <button type="button" onclick="addDistance(100)">+100</button>
                <button type="button" onclick="addDistance(50)">+50</button>
            </div>
        </div>

        <div class="form-card">
            <h3>Condition</h3>
            <div class="mood-selector">
                <input type="radio" name="mood" id="mood-good" value="good" hidden checked>
                <label for="mood-good" class="mood-btn">🤩<br>Good</label>

                <input type="radio" name="mood" id="mood-soso" value="soso" hidden>
                <label for="mood-soso" class="mood-btn">🙂<br>So-so</label>

                <input type="radio" name="mood" id="mood-bad" value="bad" hidden>
                <label for="mood-bad" class="mood-btn">😫<br>Bad</label>
            </div>
        </div>

        <button type="submit" class="floating-submit-btn" data-i18n="btnSave">기록 저장하기</button>
      </form>
    </section>

    <!-- PAGE: ANALYSIS -->
    <section id="analysis-page" class="page-section hidden">
      <div class="page-header">
        <h2 data-i18n="navAnalysis">AI 영법 정밀 분석</h2>
        <p>수영 영상을 업로드하여 자세를 교정받으세요.</p>
      </div>

      <div class="analysis-controls">
        <div class="form-row">
            <div class="form-group">
                <label>풀 길이</label>
                <select id="ana-pool-length" class="form-select">
                    <option value="25">25m (숏코스)</option>
                    <option value="50">50m (롱코스)</option>
                </select>
            </div>
            <div class="form-group">
                <label>종목</label>
                <select id="ana-event-type" class="form-select"></select>
            </div>
        </div>
      </div>
      
      <div class="upload-zone" id="upload-zone">
        <input type="file" id="video-upload" accept="video/*" hidden>
        <div class="upload-content">
          <span class="upload-icon">📹</span>
          <h3 data-i18n="uploadTitle">동영상 업로드</h3>
          <p>터치 또는 드래그 (Max 500MB)</p>
        </div>
      </div>

      <div id="analysis-results" class="analysis-results hidden">
        <div class="loading-overlay hidden" id="analysis-loader">
          <div class="spinner"></div>
          <p>AI가 영상을 분석하고 있습니다...</p>
        </div>

        <div class="result-card">
          <div class="result-header">
              <h3>분석 리포트</h3>
              <div class="lane-selector">
                  <div class="lane-tabs" id="lane-tabs"></div>
              </div>
          </div>

          <div class="video-meta">
            <span class="badge" id="res-badge-pool">--</span>
            <span class="badge" id="res-badge-event">--</span>
            <span class="badge lane-badge" id="res-badge-lane">Lane 1</span>
          </div>

          <div class="metrics-grid">
            <div class="metric-item">
              <span class="label">기록</span>
              <span class="value" id="res-total-time">--</span>
            </div>
            <div class="metric-item">
              <span class="label">반응/턴</span>
              <span class="value" id="res-reaction">--</span>
            </div>
            <div class="metric-item">
              <span class="label">효율성</span>
              <span class="value" id="res-efficiency">--</span>
            </div>
          </div>

          <div class="ai-solution-card" id="ai-solution">
              <h4>💡 AI 코칭 솔루션</h4>
              <p id="ai-solution-text">...</p>
          </div>

          <div class="table-container">
            <table class="splits-table">
                <thead id="splits-head"></thead>
                <tbody id="splits-body"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- PAGE: CLUB -->
    <section id="club-page" class="page-section hidden">
      <div class="page-header">
        <h2 data-i18n="navClub">소속 클럽</h2>
        <p>팀원들과 기록을 공유하고 경쟁하세요.</p>
      </div>

      <div id="club-selection-view">
          <div class="page-header-actions">
              <button onclick="openCreateClubModal()" class="secondary-btn small-btn">+ 클럽 만들기</button>
          </div>
          <div class="club-list" id="club-list"></div>
      </div>

      <div id="club-dashboard-view" class="hidden">
          <div class="club-header-card">
              <div class="club-info">
                  <span class="club-icon-large" id="my-club-icon">🦈</span>
                  <div>
                      <h3 id="my-club-name">Club Name</h3>
                      <p id="my-club-desc">Club Description</p>
                      <span id="my-club-type" class="club-badge">Public</span>
                  </div>
              </div>
              <button onclick="leaveClub()" class="small-text-btn text-danger">팀 탈퇴</button>
          </div>

          <div class="lane-selector">
              <div class="lane-tabs" id="club-tabs">
                  <div class="lane-tab active" onclick="switchClubTab('ranking')">🏆 랭킹</div>
                  <div class="lane-tab" onclick="switchClubTab('board')">💬 게시판</div>
              </div>
          </div>

          <div id="club-tab-ranking" class="club-tab-content">
              <div class="features">
                  <div class="feature-card">
                      <h3>🏆 팀 랭킹 (자유형 50m)</h3>
                      <ul class="leaderboard-list" id="team-leaderboard"></ul>
                  </div>
              </div>
          </div>

          <div id="club-tab-board" class="club-tab-content hidden">
              <div class="feature-card">
                  <div class="board-header">
                      <h3>팀원 소식</h3>
                      <button class="small-text-btn" onclick="postToBoard()">✏️ 기록 공유하기</button>
                  </div>
                  <div class="feed-list" id="club-feed">
                      <div class="feed-item">
                          <div class="feed-head">
                              <span class="feed-user">김물개</span>
                              <span class="feed-time">2시간 전</span>
                          </div>
                          <p class="feed-content">오늘 자유형 1500m 완주했습니다! 힘드네요 💦</p>
                      </div>
                  </div>
              </div>
          </div>
      </div>
    </section>

    <!-- Create Club Modal -->
    <div id="create-club-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>클럽 만들기</h2>
                <button class="close-btn" onclick="closeCreateClubModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="create-club-form" class="logger-form">
                    <div class="input-group">
                        <label>클럽명</label>
                        <input type="text" id="new-club-name" placeholder="멋진 클럽 이름을 지어주세요" required>
                    </div>
                    <div class="input-group">
                        <label>한줄 소개</label>
                        <input type="text" id="new-club-desc" placeholder="우리 클럽을 소개해주세요" required>
                    </div>
                    <div class="input-group">
                        <label>클럽 아이콘</label>
                        <select id="new-club-icon" class="form-select">
                            <option value="🦈">🦈 상어</option>
                            <option value="🐬">🐬 돌고래</option>
                            <option value="🐳">🐳 고래</option>
                            <option value="🦦">🦦 수달</option>
                            <option value="🐢">🐢 거북이</option>
                            <option value="🏊">🏊 수영인</option>
                            <option value="🌊">🌊 파도</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label>공개 설정</label>
                        <select id="new-club-type" class="form-select" onchange="toggleClubPassword()">
                            <option value="public">공개 (누구나 가입)</option>
                            <option value="private">비공개 (비밀번호 필요)</option>
                        </select>
                    </div>
                    <div class="input-group hidden" id="club-password-group">
                        <label>가입 비밀번호</label>
                        <input type="password" id="new-club-password" placeholder="4자리 숫자" maxlength="4">
                    </div>
                    <button type="submit" class="primary-btn" style="margin-top:1rem;">클럽 생성 완료</button>
                </form>
            </div>
        </div>
    </div>

    <!-- PAGE: PROFILE -->
    <section id="profile-page" class="page-section hidden">
      <div class="page-header">
        <h2 data-i18n="profileTitle">내 정보 관리</h2>
      </div>

      <div class="form-card" style="margin-bottom: 1.5rem;">
          <h3 data-i18n="profileHeader">👤 프로필 및 신체 정보</h3>
          
          <div class="input-group">
              <label data-i18n="labelNickname">닉네임</label>
              <input type="text" id="profile-nickname" placeholder="닉네임">
          </div>

          <div class="form-row">
              <div class="form-group half">
                  <label data-i18n="labelAge">나이</label>
                  <input type="number" id="profile-age" placeholder="25">
              </div>
              <div class="form-group half">
                  <label data-i18n="labelGender">성별</label>
                  <select id="profile-gender">
                      <option value="m" data-i18n="genderMale">남성</option>
                      <option value="f" data-i18n="genderFemale">여성</option>
                  </select>
              </div>
          </div>

          <div class="input-group">
              <label data-i18n="labelLevel">수영 레벨</label>
              <select id="profile-level" class="form-select">
                  <option value="beginner">Beginner</option>
                  <option value="intermediate">Intermediate</option>
                  <option value="advanced">Advanced</option>
                  <option value="masters">Masters</option>
                  <option value="elite">Elite</option>
              </select>
          </div>
          
          <div class="input-group">
              <label data-i18n="labelGoal">훈련 목표</label>
              <select id="profile-goal" class="form-select">
                  <option value="endurance" data-i18n="goalEndurance">지구력</option>
                  <option value="speed" data-i18n="goalSpeed">스피드</option>
                  <option value="technique" data-i18n="goalTechnique">자세 교정</option>
                  <option value="diet" data-i18n="goalDiet">다이어트</option>
                  <option value="competition" data-i18n="goalComp">대회 준비</option>
              </select>
          </div>

          <h4 style="margin-top:1.5rem; margin-bottom:0.5rem;" data-i18n="recordsHeader">🏊‍♂️ 기준 기록 (50m)</h4>
          <div class="input-group">
              <label>자유형 (Free)</label>
              <input type="text" id="record-free" placeholder="00:30.00">
          </div>
          <div class="input-group">
              <label>평영 (Breast)</label>
              <input type="text" id="record-breast" placeholder="00:40.00">
          </div>

          <button onclick="saveProfileChanges()" class="secondary-btn" style="margin-top: 1rem;" data-i18n="btnUpdate">변경사항 저장</button>
      </div>

      <!-- Competition Form (Preserved) -->
      <form id="competition-form" class="logger-form">
         <div class="form-card">
             <h3 data-i18n="recentCompTitle">🏆 새 대회 기록 추가</h3>
             <div class="form-group">
                <label>대회/측정명</label>
                <input type="text" id="comp-name" placeholder="예: 3월 정기 측정" required>
             </div>
             <div class="form-row">
                 <div class="form-group half">
                    <label>날짜</label>
                    <input type="date" id="comp-date" required>
                 </div>
                 <div class="form-group half">
                     <label>기록</label>
                     <input type="text" id="comp-time" placeholder="00:00.00" required>
                 </div>
             </div>
             <div class="form-group">
                 <label>종목</label>
                 <select id="comp-event" class="form-select">
                     <option value="자유형 50m">자유형 50m</option>
                     <option value="자유형 100m">자유형 100m</option>
                     <option value="배영 50m">배영 50m</option>
                     <option value="평영 50m">평영 50m</option>
                     <option value="접영 50m">접영 50m</option>
                     <option value="개인혼영 200m">개인혼영 200m</option>
                 </select>
             </div>
             <button type="submit" class="primary-btn" data-i18n="btnSave">저장하기</button>
         </div>
      </form>

      <div class="records-list-container">
          <h3>📜 기록 히스토리</h3>
          <ul id="records-list" class="records-list"></ul>
      </div>
    </section>

  </main>

  <!-- Terminology Modal -->
  <div id="term-modal" class="modal-overlay hidden">
      <div class="modal-content">
          <div class="modal-header">
              <h2 data-i18n="termTitle">훈련 용어 가이드</h2>
              <button class="close-btn" onclick="closeTermModal()">&times;</button>
          </div>
          <div class="term-grid">
              <div class="term-card">
                  <div class="term-title">EN1 (Endurance 1)</div>
                  <div class="term-desc" data-i18n="descEN1">기초 지구력. 편안한 호흡으로 오래 수영할 수 있는 강도. (최대 심박수 60-70%)</div>
              </div>
              <div class="term-card">
                  <div class="term-title">EN2 (Endurance 2)</div>
                  <div class="term-desc" data-i18n="descEN2">유산소 역치. 약간 숨이 차지만 페이스를 유지할 수 있는 강도. (최대 심박수 70-80%)</div>
              </div>
              <div class="term-card">
                  <div class="term-title">EN3 (VO2 Max)</div>
                  <div class="term-desc" data-i18n="descEN3">최대 산소 섭취량. 숨이 많이 차고 지속하기 힘든 강도. (최대 심박수 80-90%)</div>
              </div>
              <div class="term-card">
                  <div class="term-title">SP1 (Sprint 1)</div>
                  <div class="term-desc" data-i18n="descSP1">젖산 내성. 최고 속도로 짧은 거리를 반복하며 젖산을 견디는 훈련.</div>
              </div>
              <div class="term-card">
                  <div class="term-title">Drill</div>
                  <div class="term-desc" data-i18n="descDrill">자세 교정을 위한 부분 동작 연습.</div>
              </div>
          </div>
      </div>
  </div>

  <!-- Mobile Bottom Navigation -->
  <nav class="mobile-bottom-nav">
    <a href="#" data-page="dashboard" class="nav-item active">
      <span class="nav-icon">🏠</span>
      <span class="nav-text" data-i18n="navDashboard">홈</span>
    </a>
    <a href="#" data-page="logger" class="nav-item">
      <span class="nav-icon">✏️</span>
      <span class="nav-text" data-i18n="navLogger">일지</span>
    </a>
    <a href="#" data-page="analysis" class="nav-item">
      <span class="nav-icon">📷</span>
      <span class="nav-text" data-i18n="navAnalysis">분석</span>
    </a>
    <a href="#" data-page="club" class="nav-item">
      <span class="nav-icon">🤝</span>
      <span class="nav-text" data-i18n="navClub">클럽</span>
    </a>
    <a href="#" data-page="profile" class="nav-item">
      <span class="nav-icon">👤</span>
      <span class="nav-text" data-i18n="navProfile">기록</span>
    </a>
  </nav>

  <script type="module" src="/main.js"></script>
</body>
</html>